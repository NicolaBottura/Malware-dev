# Keylogger Malware

<p align="center">
  <img src="https://github.com/NicolaBottura/Malware-dev/assets/32301476/fd5a41be-d014-498b-b02e-9ee7d8f4395d" alt="cover-keylogger"/>
</p>

This repository contains a keylogger written in C++ for educational and research purposes. The keylogger captures information about pressed keys, changes in the foreground window, and clipboard content.
More details [here](https://nicolabottura.github.io/Keylogger.html).

## Table of Contents
- [Features](#features)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Building](#building)
- [Output](#output)
- [Disclaimer](#disclaimer)

## Features
- **Keylogging:**
  - Captures pressed keys and logs them with their associated names.
  - Utilizes Microsoft's API [SetWindowsHookEx](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexw) to register a hook procedure for `WH_KEYBOARD_LL`.

- **Foreground Window Tracking:**
  - Records changes in the foreground window, including the window title.
  - Leverages [GetForegroundWindow](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getforegroundwindow) and [GetWindowText](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getwindowtextw) to retrieve the window in focus and save its title.

- **Clipboard Monitoring:**
  - Monitors changes in the clipboard content.
  - Exploits [SetClipboardViewer](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setclipboardviewer) to add a window to the clipboard viewer chain. Listen for [WM_CHANGECBCHAIN](https://learn.microsoft.com/en-us/windows/win32/dataxchg/wm-changecbchain) and [WM_DRAWCLIPBOARD](https://learn.microsoft.com/en-us/windows/win32/dataxchg/wm-drawclipboard) window messages.

These three operations are managed by separate threads, running in parallel for a specified duration (adjustable with the `DELAY` macro in `main.cpp`). The data is saved in a buffer (vector of wide strings + string type) while executing and then written to a logfile at the end of the execution. The output file path can be modified by chaning the `PATH` macro.

## Getting Started

### Prerequisites
- Visual Studio for building the project.
- Windows operating system.

### Building
1. Clone the repository to your local machine.
   ```git clone [https://github.com/yourusername/keylogger.git](https://github.com/NicolaBottura/Malware-dev.git)https://github.com/NicolaBottura/Malware-dev.git```
2. Navigate to `Keylogger` folder and open the solution file (.sln).
3. Compile it, run the executable and start typing..

<p align="center">
  <img src="https://github.com/NicolaBottura/Malware-dev/assets/32301476/8c4a1831-6593-4cb7-bf9b-5e70632067bb" alt="cat-gif">
</p>

## Output
The output with the recorded keys, windows and clipboard data will be writte in a logfile at the end of the execution of the threads managing these operations.
As an example, look at the following output:
```
----------------
Current Window = Windows PowerShell
Clipboard context changed. Text = C:\Users\student\Desktop\Malware-dev\Keylogger>
Recorded keys = Left Windows
----------------
Current Window = Search
Recorded keys = G
Recorded keys = O
Recorded keys = O
Recorded keys = G
Recorded keys = L
Recorded keys = Enter
----------------
Current Window = New Tab - Google Chrome
Recorded keys = F
Recorded keys = A
Recorded keys = Enter
Recorded keys = T
Recorded keys = E
Recorded keys = S
Recorded keys = T
Recorded keys = Tab
Recorded keys = T
Recorded keys = E
Recorded keys = S
Recorded keys = T
Recorded keys = Enter
Recorded keys = Ctrl
Recorded keys = C
Clipboard context changed. Text = Connect with friends and the world around you on Facebook.
Recorded keys = Ctrl
Recorded keys = W
----------------
Current Window = Windows PowerShell
----------------
```
Here are the steps taken:
1. Pressed the `Left Windows key` (Windows logo key) to access the `Search` window.
2. Typed `googl` and pressed `Enter` when the Google Chrome application appeared in the list.
3. Typed `fa` and pressed `Enter` again as the facebook.com link was already visible in the address bar.
4. Entered fake credentials `test:test`, hit `Enter` again, and copied a phrase from the Facebook main page.
5. Closed the current tab using `Ctrl+w` and returned to the PowerShell window.

## Disclaimer
This repository is for research purposes only, the use of this code is your responsibility. I take NO responsibility and/or liability for how you choose to use any of the source code available here.
